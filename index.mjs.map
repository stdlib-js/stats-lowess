{"version":3,"file":"index.mjs","sources":["../lib/lowest.js","../lib/lowess.js","../lib/main.js","../lib/validate.js"],"sourcesContent":["/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nimport sqrt from '@stdlib/math-base-special-sqrt';\nimport abs from '@stdlib/math-base-special-abs';\nimport max from '@stdlib/math-base-special-max';\nimport pow from '@stdlib/math-base-special-pow';\n\n\n// MAIN //\n\n/**\n* Calculates the fitted value `ys` for a value `xs` on the horizontal axis.\n*\n* ## Method\n*\n* -   The smoothed value for the x-axis value at the current index is computed using a (robust) locally weighted regression of degree one.  The tricube weight function is used with `h` equal to the maximum of `xs - x[ nleft ]` and `x[ nright ] - xs`.\n*\n* ## References\n*\n* -   Cleveland, William S. 1979. \"Robust Locally and Smoothing Weighted Regression Scatterplots.\" _Journal of the American Statistical Association_ 74 (368): 829–36. doi:[10.1080/01621459.1979.10481038](https://doi.org/10.1080/01621459.1979.10481038).\n* -   Cleveland, William S. 1981. \"Lowess: A program for smoothing scatterplots by robust locally weighted regression.\" _American Statistician_ 35 (1): 54–55. doi:[10.2307/2683591](https://doi.org/10.2307/2683591).\n*\n* @private\n* @param {NumericArray} x - ordered x-axis values (abscissa values)\n* @param {NumericArray} y - corresponding y-axis values (ordinate values)\n* @param {PositiveInteger} n - number of observations\n* @param {NonNegativeInteger} i - current index\n* @param {NonNegativeInteger} nleft - index of the first point used in computing the fitted value\n* @param {NonNegativeInteger} nright - index of the last point used in computing the fitted value\n* @param {ProbabilityArray} w - weights at indices from `nleft` to `nright` to be used in the calculation of the fitted value\n* @param {boolean} userw - boolean indicating whether a robust fit is carried out using the weights in `rw`\n* @param {ProbabilityArray} rw - robustness weights\n* @returns {number} fitted value\n*/\nfunction lowest( x, y, n, i, nleft, nright, w, userw, rw ) {\n\tvar range;\n\tvar nrt;\n\tvar h1;\n\tvar h9;\n\tvar xs;\n\tvar ys;\n\tvar h;\n\tvar a;\n\tvar b;\n\tvar c;\n\tvar r;\n\tvar j;\n\n\txs = x[ i ];\n\trange = x[ n - 1 ] - x[ 0 ];\n\th = max( xs - x[ nleft ], x[ nright ] - xs );\n\th9 = 0.999 * h;\n\th1 = 0.001 * h;\n\n\t// Compute weights (pick up all ties on right):\n\ta = 0.0; // sum of weights\n\tfor ( j = nleft; j < n; j++ ) {\n\t\tw[ j ] = 0.0;\n\t\tr = abs( x[ j ] - xs );\n\t\tif ( r <= h9 ) { // small enough for non-zero weight\n\t\t\tif ( r > h1 ) {\n\t\t\t\tw[ j ] = pow( 1.0-pow( r/h, 3.0 ), 3.0 );\n\t\t\t} else {\n\t\t\t\tw[ j ] = 1.0;\n\t\t\t}\n\t\t\tif ( userw ) {\n\t\t\t\tw[ j ] *= rw[ j ];\n\t\t\t}\n\t\t\ta += w[ j ];\n\t\t}\n\t\telse if ( x[ j ] > xs ) {\n\t\t\tbreak; // get out at first zero weight on right\n\t\t}\n\t}\n\tnrt = j - 1; // rightmost point (may be greater than `nright` because of ties)\n\tif ( a <= 0.0 ) {\n\t\treturn y[ i ];\n\t}\n\n\t// Make sum of weights equal to one:\n\tfor ( j = nleft; j <= nrt; j++ ) {\n\t\tw[ j ] /= a;\n\t}\n\n\tif ( h > 0.0 ) { // use linear fit\n\t\t// Find weighted center of x values:\n\t\ta = 0.0;\n\t\tfor ( j = nleft; j <= nrt; j++ ) {\n\t\t\ta += w[ j ] * x[ j ];\n\t\t}\n\t\tb = xs - a;\n\t\tc = 0.0;\n\t\tfor ( j = nleft; j <= nrt; j++ ) {\n\t\t\tc += w[ j ] * pow( x[ j ] - a, 2.0 );\n\t\t}\n\t\tif ( sqrt( c ) > 0.001 * range ) {\n\t\t\t// Points are spread out enough to compute slope:\n\t\t\tb /= c;\n\t\t\tfor ( j = nleft; j <= nrt; j++ ) {\n\t\t\t\tw[ j ] *= ( 1.0 + ( b*(x[j]-a) ) );\n\t\t\t}\n\t\t}\n\t}\n\tys = 0.0;\n\tfor ( j = nleft; j <= nrt; j++ ) {\n\t\tys += w[ j ] * y[ j ];\n\t}\n\treturn ys;\n}\n\n\n// EXPORTS //\n\nexport default lowest;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nimport floor from '@stdlib/math-base-special-floor';\nimport abs from '@stdlib/math-base-special-abs';\nimport max from '@stdlib/math-base-special-max';\nimport min from '@stdlib/math-base-special-min';\nimport pow from '@stdlib/math-base-special-pow';\nimport lowest from './lowest.js';\n\n\n// FUNCTIONS //\n\n/**\n* Comparator function used to sort values in ascending order.\n*\n* @private\n* @param {number} a - first value\n* @param {number} b - second value\n* @returns {number} difference between `a` and `b`\n*/\nfunction ascending( a, b ) {\n\treturn a - b;\n}\n\n\n// MAIN //\n\n/**\n* Locally-weighted polynomial regression via the LOWESS algorithm.\n*\n* ## Method\n*\n* -   Calculates fitted values using a nearest neighbor function and robust locally weighted regression of degree one with the tricube weight function.\n*\n* ## References\n*\n* -   Cleveland, William S. 1979. \"Robust Locally and Smoothing Weighted Regression Scatterplots.\" _Journal of the American Statistical Association_ 74 (368): 829–36. doi:[10.1080/01621459.1979.10481038](https://doi.org/10.1080/01621459.1979.10481038).\n* -   Cleveland, William S. 1981. \"Lowess: A program for smoothing scatterplots by robust locally weighted regression.\" _American Statistician_ 35 (1): 54–55. doi:[10.2307/2683591](https://doi.org/10.2307/2683591).\n*\n* @private\n* @param {NumericArray} x - ordered x-axis values (abscissa values)\n* @param {NumericArray} y - corresponding y-axis values (ordinate values)\n* @param {PositiveInteger} n - number of observations\n* @param {PositiveNumber} f - smoother span (proportion of points which influence smoothing at each value)\n* @param {NonNegativeInteger} nsteps - number of iterations in the robust fit\n* @param {PositiveNumber} delta - nonnegative parameter which may be used to reduce the number of computations\n* @returns {Object} sorted x-values and fitted values\n*/\nfunction lowess( x, y, n, f, nsteps, delta ) {\n\tvar nright;\n\tvar denom;\n\tvar nleft;\n\tvar alpha;\n\tvar cmad;\n\tvar iter;\n\tvar last;\n\tvar cut;\n\tvar res;\n\tvar m1;\n\tvar m2;\n\tvar ns;\n\tvar c1;\n\tvar c9;\n\tvar d1;\n\tvar d2;\n\tvar rw;\n\tvar ys;\n\tvar i;\n\tvar j;\n\tvar r;\n\n\tif ( n < 2 ) {\n\t\treturn y;\n\t}\n\tys = new Array( n );\n\tres = new Array( n );\n\trw = new Array( n );\n\n\t// Use at least two and at most n points:\n\tns = max( min( floor( f * n ), n ), 2 );\n\n\t// Robustness iterations:\n\tfor ( iter = 1; iter <= nsteps + 1; iter++ ) {\n\t\tnleft = 0;\n\t\tnright = ns - 1;\n\t\tlast = -1; // index of previously estimated point\n\t\ti = 0; // index of current point\n\t\tdo {\n\t\t\twhile ( nright < n - 1 ) {\n\t\t\t\t// Move `nleft`, `nright` to the right if radius decreases:\n\t\t\t\td1 = x[ i ] - x[ nleft ];\n\t\t\t\td2 = x[ nright + 1 ] - x[ i ];\n\n\t\t\t\t// If d1 <= d2 with x[nright+1] == x[nright], lowest fixes:\n\t\t\t\tif ( d1 <= d2 ) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t// Radius will not decrease by a move to the right...\n\t\t\t\tnleft += 1;\n\t\t\t\tnright += 1;\n\t\t\t}\n\t\t\t// Fitted value at x[ i ]:\n\t\t\tys[ i ] = lowest( x, y, n, i, nleft, nright, res, (iter > 1), rw );\n\n\t\t\tif ( last < i - 1 ) {\n\t\t\t\tdenom = x[ i ] - x[ last ];\n\t\t\t\tfor ( j = last + 1; j < i; j++ ) {\n\t\t\t\t\talpha = ( x[ j ] - x[ last ] ) / denom;\n\t\t\t\t\tys[ j ] = ( alpha*ys[ i ] ) + ( (1.0-alpha) * ys[ last ] );\n\t\t\t\t}\n\t\t\t}\n\t\t\tlast = i;\n\t\t\tcut = x[ last ] + delta;\n\t\t\tfor ( i = last + 1; i < n; i++ ) {\n\t\t\t\tif ( x[ i ] > cut ) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif ( x[ i ] === x[ last ] ) {\n\t\t\t\t\tys[ i ] = ys[ last ];\n\t\t\t\t\tlast = i;\n\t\t\t\t}\n\t\t\t}\n\t\t\ti = max( last + 1, i - 1 );\n\t\t} while ( last < n - 1 );\n\n\t\t// Calculate Residuals:\n\t\tfor ( i = 0; i < n; i++ ) {\n\t\t\tres[ i ] = y[ i ] - ys[ i ];\n\t\t}\n\t\tif ( iter > nsteps ) {\n\t\t\tbreak; // Compute robustness weights except last time...\n\t\t}\n\t\tfor ( i = 0; i < n; i++ ) {\n\t\t\trw[i] = abs( res[i] );\n\t\t}\n\t\trw.sort( ascending );\n\t\tm1 = floor( n / 2.0 );\n\t\tm2 = n - m1 - 1.0;\n\t\tcmad = 3.0 * ( rw[m1] + rw[m2] );\n\t\tc9 = 0.999 * cmad;\n\t\tc1 = 0.001 * cmad;\n\t\tfor ( i = 0; i < n; i++ ) {\n\t\t\tr = abs( res[i] );\n\t\t\tif ( r <= c1 ) {\n\t\t\t\trw[ i ] = 1.0; // near 0, avoid underflow\n\t\t\t}\n\t\t\telse if ( r > c9 ) {\n\t\t\t\trw[ i ] = 0.0;  // near 1, avoid underflow\n\t\t\t}\n\t\t\telse {\n\t\t\t\trw[ i ] = pow( 1.0 - pow( r / cmad, 2.0 ), 2.0 );\n\t\t\t}\n\t\t}\n\t}\n\treturn {\n\t\t'x': x,\n\t\t'y': ys\n\t};\n}\n\n\n// EXPORTS //\n\nexport default lowess;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nimport { primitives as isNumberArray } from '@stdlib/assert-is-number-array';\nimport isTypedArrayLike from '@stdlib/assert-is-typed-array-like';\nimport range from '@stdlib/stats-base-range';\nimport format from '@stdlib/error-tools-fmtprodmsg';\nimport lowess from './lowess.js';\nimport validate from './validate.js';\n\n\n// FUNCTIONS //\n\n/**\n* Comparator function used to sort (x,y)-pairs in ascending order by the first coordinate.\n*\n* @private\n* @param {Array} a - first pair\n* @param {Array} b - second pair\n* @returns {number} difference between `a` and `b`\n*/\nfunction ascending( a, b ) {\n\treturn a[ 0 ] - b[ 0 ];\n}\n\n\n// MAIN //\n\n/**\n* Locally-weighted polynomial regression via the LOWESS algorithm.\n*\n* ## References\n*\n* -   Cleveland, William S. 1979. \"Robust Locally and Smoothing Weighted Regression Scatterplots.\" _Journal of the American Statistical Association_ 74 (368): 829–36. doi:[10.1080/01621459.1979.10481038](https://doi.org/10.1080/01621459.1979.10481038).\n* -   Cleveland, William S. 1981. \"Lowess: A program for smoothing scatterplots by robust locally weighted regression.\" _American Statistician_ 35 (1): 54–55. doi:[10.2307/2683591](https://doi.org/10.2307/2683591).\n*\n* @param {NumericArray} x - ordered x-axis values (abscissa values)\n* @param {NumericArray} y - corresponding y-axis values (ordinate values)\n* @param {Options} options - function options\n* @param {PositiveNumber} [options.f=2/3] - smoother span (proportion of points which influence smoothing at each value)\n* @param {integer} [options.nsteps=3] - number of iterations in the robust fit (fewer iterations translates to faster function execution)\n* @param {NonNegativeNumber} [options.delta] - nonnegative parameter which may be used to reduce the number of computations\n* @param {boolean} [options.sorted=false] - boolean indicating if the input array `x` is already in sorted order\n* @throws {TypeError} first argument must be a numeric array\n* @throws {TypeError} second argument must be a numeric array\n* @throws {RangeError} first and second arguments must have the same length\n* @returns {Object} ordered x-values and fitted values\n*/\nfunction main( x, y, options ) {\n\tvar nsteps;\n\tvar delta;\n\tvar opts;\n\tvar err;\n\tvar xy;\n\tvar f;\n\tvar i;\n\tvar n;\n\tvar r;\n\n\tif ( !isTypedArrayLike( x ) && !isNumberArray( x ) ) {\n\t\tthrow new TypeError( format( '1Lh8R', x ) );\n\t}\n\tif ( !isTypedArrayLike( y ) && !isNumberArray( y ) ) {\n\t\tthrow new TypeError( format( '1Lh9k', y ) );\n\t}\n\tn = x.length;\n\tif ( y.length !== n ) {\n\t\tthrow new RangeError( format('1Lh1E') );\n\t}\n\topts = {};\n\tif ( arguments.length > 2 ) {\n\t\terr = validate( opts, options );\n\t\tif ( err ) {\n\t\t\tthrow err;\n\t\t}\n\t}\n\t// Input data has to be sorted:\n\tif ( opts.sorted !== true ) {\n\t\t// Copy to prevent mutation and sort by x:\n\t\txy = new Array( n );\n\t\tfor ( i = 0; i < n; i++ ) {\n\t\t\txy[ i ] = [ x[ i ], y[ i ] ];\n\t\t}\n\t\txy.sort( ascending ); // TODO: Revisit once we have function for sorting multiple arrays by the elements of one of the arrays\n\t\tx = new Array( n );\n\t\ty = new Array( n );\n\t\tfor ( i = 0; i < n; i++ ) {\n\t\t\tx[ i ] = xy[ i ][ 0 ];\n\t\t\ty[ i ] = xy[ i ][ 1 ];\n\t\t}\n\t}\n\tif ( opts.nsteps === void 0 ) {\n\t\tnsteps = 3;\n\t} else {\n\t\tnsteps = opts.nsteps;\n\t}\n\tif ( opts.f === void 0 ) {\n\t\tf = 2.0/3.0;\n\t} else {\n\t\tf = opts.f;\n\t}\n\tif ( opts.delta === void 0 ) {\n\t\tr = range( n, x, 1 );\n\t\tdelta = 0.01 * r;\n\t} else {\n\t\tdelta = opts.delta;\n\t}\n\treturn lowess( x, y, n, f, nsteps, delta );\n}\n\n\n// EXPORTS //\n\nexport default main;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2018 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n'use strict';\n\n// MODULES //\n\nimport hasOwnProp from '@stdlib/assert-has-own-property';\nimport isObject from '@stdlib/assert-is-plain-object';\nimport isPositiveNumber from '@stdlib/assert-is-positive-number';\nimport { isPrimitive as isNonNegativeInteger } from '@stdlib/assert-is-nonnegative-integer';\nimport { isPrimitive as isNonNegativeNumber } from '@stdlib/assert-is-nonnegative-number';\nimport { isPrimitive as isBoolean } from '@stdlib/assert-is-boolean';\nimport format from '@stdlib/error-tools-fmtprodmsg';\n\n\n// MAIN //\n\n/**\n* Validates function options.\n*\n* @private\n* @param {Object} opts - destination object\n* @param {Options} options - function options\n* @param {Probability} [options.f] - smoother span (proportion of points which influence smoothing at each value)\n* @param {NonNegativeInteger} [options.nsteps] - number of iterations in the robust fit\n* @param {NonNegativeNumber} [options.delta] - nonnegative parameter which may be used to save computations\n* @param {boolean} [options.sorted] - boolean indicating if the input array is in sorted order\n* @returns {(Error|null)} null or an error object\n*\n* @example\n* var opts = {};\n* var options = {\n*     'f': 0.75,\n*     'nsteps': 6,\n*     'delta': 0.03,\n*     'sorted': true\n* };\n* var err = validate( opts, options );\n* if ( err ) {\n*     throw err;\n* }\n*/\nfunction validate( opts, options ) {\n\tif ( !isObject( options ) ) {\n\t\treturn new TypeError( format( '1Lh2V', options ) );\n\t}\n\tif ( hasOwnProp( options, 'f' ) ) {\n\t\topts.f = options.f;\n\t\tif ( !isPositiveNumber( opts.f ) ) {\n\t\t\treturn new TypeError( format( '1Lh4D', 'f', opts.f ) );\n\t\t}\n\t}\n\tif ( hasOwnProp( options, 'nsteps' ) ) {\n\t\topts.nsteps = options.nsteps;\n\t\tif ( !isNonNegativeInteger( opts.nsteps ) ) {\n\t\t\treturn new TypeError( format( '1Lh2t', 'nsteps', opts.nsteps ) );\n\t\t}\n\t}\n\tif ( hasOwnProp( options, 'delta' ) ) {\n\t\topts.delta = options.delta;\n\t\tif ( !isNonNegativeNumber( opts.delta ) ) {\n\t\t\treturn new TypeError( format( '1Lh4k', 'delta', opts.delta ) );\n\t\t}\n\t}\n\tif ( hasOwnProp( options, 'sorted' ) ) {\n\t\topts.sorted = options.sorted;\n\t\tif ( !isBoolean( opts.sorted ) ) {\n\t\t\treturn new TypeError( format( '1Lh2o', 'sorted', opts.sorted ) );\n\t\t}\n\t}\n\treturn null;\n}\n\n\n// EXPORTS //\n\nexport default validate;\n"],"names":["lowest","x","y","n","i","nleft","nright","w","userw","rw","range","nrt","h1","h9","xs","ys","h","a","b","c","r","j","max","abs","pow","sqrt","ascending","main","options","opts","err","xy","isTypedArrayLike","isNumberArray","TypeError","format","length","RangeError","arguments","isObject","hasOwnProp","f","isPositiveNumber","nsteps","isNonNegativeInteger","delta","isNonNegativeNumber","sorted","isBoolean","validate","Array","sort","denom","alpha","cmad","iter","last","cut","res","m1","m2","ns","c1","c9","min","floor","lowess"],"mappings":"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"}